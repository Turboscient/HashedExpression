<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- (c) 2014 Christopher Kumar Anand</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Helper functions/instances to make pattern guards involving Expressions</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- easier to read.</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HashedExpression.Internal.Pattern</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.IntMap.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IM</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.HT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">splitLast</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">viewR</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">union</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Debug.Trace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">trace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">traceShowId</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Internal.Expression.html"><span class="hs-identifier">HashedExpression.Internal.Expression</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Internal.Inner.html"><span class="hs-identifier">HashedExpression.Internal.Inner</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Internal.Inner.html"><span class="hs-identifier">HashedExpression.Internal.Inner</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Internal.Node.html"><span class="hs-identifier">HashedExpression.Internal.Node</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Internal.Utils.html"><span class="hs-identifier">HashedExpression.Internal.Utils</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="HashedExpression.Operation.html"><span class="hs-identifier">HashedExpression.Operation</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">^</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- | Pattern for normalizier</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-keyword">type</span><span> </span><a name="Capture"><a href="HashedExpression.Internal.Pattern.html#Capture"><span class="hs-identifier">Capture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="ListCapture"><a href="HashedExpression.Internal.Pattern.html#ListCapture"><span class="hs-identifier">ListCapture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">type</span><span> </span><a name="PowerCapture"><a href="HashedExpression.Internal.Pattern.html#PowerCapture"><span class="hs-identifier">PowerCapture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">type</span><span> </span><a name="RotateAmountCapture"><a href="HashedExpression.Internal.Pattern.html#RotateAmountCapture"><span class="hs-identifier">RotateAmountCapture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | List holes to captures many elements</span><span>
</span><a name="line-40"></a><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span class="hs-keyword">data</span><span> </span><a name="PatternList"><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier">PatternList</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-42"></a><span>    </span><a name="PListHole"><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier">PListHole</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">)</span><span> </span><a href="HashedExpression.Internal.Pattern.html#ListCapture"><span class="hs-identifier hs-type">ListCapture</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-46"></a><span>    </span><a name="local-8214565720323791457"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679262645"><a href="#local-6989586621679262645"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(Pattern -&gt; Pattern)&quot;</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | Pattern power to capture the alpha in x ^ alpha</span><span>
</span><a name="line-49"></a><span class="hs-comment">--</span><span>
</span><a name="line-50"></a><span class="hs-keyword">data</span><span> </span><a name="PatternPower"><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier">PatternPower</span></a></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="PPowerHole"><a href="HashedExpression.Internal.Pattern.html#PPowerHole"><span class="hs-identifier">PPowerHole</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PowerCapture"><span class="hs-identifier hs-type">PowerCapture</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PPowerConst"><a href="HashedExpression.Internal.Pattern.html#PPowerConst"><span class="hs-identifier">PPowerConst</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PPowerMul"><a href="HashedExpression.Internal.Pattern.html#PPowerMul"><span class="hs-identifier">PPowerMul</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PPowerSum"><a href="HashedExpression.Internal.Pattern.html#PPowerSum"><span class="hs-identifier">PPowerSum</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | PatternRotateAmount to capture the amount in (rotate amount x)</span><span>
</span><a name="line-58"></a><span class="hs-comment">--</span><span>
</span><a name="line-59"></a><span class="hs-keyword">data</span><span> </span><a name="PatternRotateAmount"><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier">PatternRotateAmount</span></a></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="PRotateAmountHole"><a href="HashedExpression.Internal.Pattern.html#PRotateAmountHole"><span class="hs-identifier">PRotateAmountHole</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#RotateAmountCapture"><span class="hs-identifier hs-type">RotateAmountCapture</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRotateAmountSum"><a href="HashedExpression.Internal.Pattern.html#PRotateAmountSum"><span class="hs-identifier">PRotateAmountSum</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRotateAmountNegate"><a href="HashedExpression.Internal.Pattern.html#PRotateAmountNegate"><span class="hs-identifier">PRotateAmountNegate</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-66"></a><span class="hs-comment">--</span><span>
</span><a name="line-67"></a><span class="hs-keyword">data</span><span> </span><a name="Pattern"><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier">Pattern</span></a></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="PHole"><a href="HashedExpression.Internal.Pattern.html#PHole"><span class="hs-identifier">PHole</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Capture"><span class="hs-identifier hs-type">Capture</span></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- Ref to a node in the expression</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRef"><a href="HashedExpression.Internal.Pattern.html#PRef"><span class="hs-identifier">PRef</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- Ref to head of the list captures:</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PHead"><a href="HashedExpression.Internal.Pattern.html#PHead"><span class="hs-identifier">PHead</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSumList"><a href="HashedExpression.Internal.Pattern.html#PSumList"><span class="hs-identifier">PSumList</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PMulList"><a href="HashedExpression.Internal.Pattern.html#PMulList"><span class="hs-identifier">PMulList</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PConst"><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier">PConst</span></a></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PScalarConst"><a href="HashedExpression.Internal.Pattern.html#PScalarConst"><span class="hs-identifier">PScalarConst</span></a></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- Pattern for scalar const used in RHS</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSum"><a href="HashedExpression.Internal.Pattern.html#PSum"><span class="hs-identifier">PSum</span></a></a><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PMul"><a href="HashedExpression.Internal.Pattern.html#PMul"><span class="hs-identifier">PMul</span></a></a><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PNeg"><a href="HashedExpression.Internal.Pattern.html#PNeg"><span class="hs-identifier">PNeg</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PScale"><a href="HashedExpression.Internal.Pattern.html#PScale"><span class="hs-identifier">PScale</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PDiv"><a href="HashedExpression.Internal.Pattern.html#PDiv"><span class="hs-identifier">PDiv</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSqrt"><a href="HashedExpression.Internal.Pattern.html#PSqrt"><span class="hs-identifier">PSqrt</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSin"><a href="HashedExpression.Internal.Pattern.html#PSin"><span class="hs-identifier">PSin</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCos"><a href="HashedExpression.Internal.Pattern.html#PCos"><span class="hs-identifier">PCos</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PTan"><a href="HashedExpression.Internal.Pattern.html#PTan"><span class="hs-identifier">PTan</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PExp"><a href="HashedExpression.Internal.Pattern.html#PExp"><span class="hs-identifier">PExp</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PLog"><a href="HashedExpression.Internal.Pattern.html#PLog"><span class="hs-identifier">PLog</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSinh"><a href="HashedExpression.Internal.Pattern.html#PSinh"><span class="hs-identifier">PSinh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PCosh"><a href="HashedExpression.Internal.Pattern.html#PCosh"><span class="hs-identifier">PCosh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PTanh"><a href="HashedExpression.Internal.Pattern.html#PTanh"><span class="hs-identifier">PTanh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAsin"><a href="HashedExpression.Internal.Pattern.html#PAsin"><span class="hs-identifier">PAsin</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAcos"><a href="HashedExpression.Internal.Pattern.html#PAcos"><span class="hs-identifier">PAcos</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAtan"><a href="HashedExpression.Internal.Pattern.html#PAtan"><span class="hs-identifier">PAtan</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAsinh"><a href="HashedExpression.Internal.Pattern.html#PAsinh"><span class="hs-identifier">PAsinh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAcosh"><a href="HashedExpression.Internal.Pattern.html#PAcosh"><span class="hs-identifier">PAcosh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PAtanh"><a href="HashedExpression.Internal.Pattern.html#PAtanh"><span class="hs-identifier">PAtanh</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRealImag"><a href="HashedExpression.Internal.Pattern.html#PRealImag"><span class="hs-identifier">PRealImag</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRealPart"><a href="HashedExpression.Internal.Pattern.html#PRealPart"><span class="hs-identifier">PRealPart</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PImagPart"><a href="HashedExpression.Internal.Pattern.html#PImagPart"><span class="hs-identifier">PImagPart</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PInnerProd"><a href="HashedExpression.Internal.Pattern.html#PInnerProd"><span class="hs-identifier">PInnerProd</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PPiecewise"><a href="HashedExpression.Internal.Pattern.html#PPiecewise"><span class="hs-identifier">PPiecewise</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PMulRest"><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier">PMulRest</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#ListCapture"><span class="hs-identifier hs-type">ListCapture</span></a><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PSumRest"><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier">PSumRest</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#ListCapture"><span class="hs-identifier hs-type">ListCapture</span></a><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PPower"><a href="HashedExpression.Internal.Pattern.html#PPower"><span class="hs-identifier">PPower</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PRotate"><a href="HashedExpression.Internal.Pattern.html#PRotate"><span class="hs-identifier">PRotate</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PReFT"><a href="HashedExpression.Internal.Pattern.html#PReFT"><span class="hs-identifier">PReFT</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PImFT"><a href="HashedExpression.Internal.Pattern.html#PImFT"><span class="hs-identifier">PImFT</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PTwiceReFT"><a href="HashedExpression.Internal.Pattern.html#PTwiceReFT"><span class="hs-identifier">PTwiceReFT</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PTwiceImFT"><a href="HashedExpression.Internal.Pattern.html#PTwiceImFT"><span class="hs-identifier">PTwiceImFT</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><a href="HashedExpression.Internal.Pattern.html#~%2A"><span class="hs-operator hs-var">~*</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">6</span><span> </span><a href="HashedExpression.Internal.Pattern.html#~%2B"><span class="hs-operator hs-var">~+</span></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">class</span><span> </span><a name="MulRestOp"><a href="HashedExpression.Internal.Pattern.html#MulRestOp"><span class="hs-identifier">MulRestOp</span></a></a><span> </span><a name="local-6989586621679262629"><a href="#local-6989586621679262629"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679262630"><a href="#local-6989586621679262630"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679262631"><a href="#local-6989586621679262631"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-special">(</span><a name="~%2A"><a href="HashedExpression.Internal.Pattern.html#~%2A"><span class="hs-operator">~*</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679262629"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262630"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262631"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Pattern.html#MulRestOp"><span class="hs-identifier hs-type">MulRestOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720324037412"><a href="HashedExpression.Internal.Pattern.html#~%2A"><span class="hs-operator">~*</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier hs-var">PMulRest</span></a><span> </span><a name="local-6989586621679262642"><a href="#local-6989586621679262642"><span class="hs-identifier">listCapture</span></a></a><span> </span><a name="local-6989586621679262643"><a href="#local-6989586621679262643"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262644"><a href="#local-6989586621679262644"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier hs-var">PMulRest</span></a><span> </span><a href="#local-6989586621679262642"><span class="hs-identifier hs-var">listCapture</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262643"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262644"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-keyword">class</span><span> </span><a name="SumRestOp"><a href="HashedExpression.Internal.Pattern.html#SumRestOp"><span class="hs-identifier">SumRestOp</span></a></a><span> </span><a name="local-6989586621679262626"><a href="#local-6989586621679262626"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679262627"><a href="#local-6989586621679262627"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679262628"><a href="#local-6989586621679262628"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">(</span><a name="~%2B"><a href="HashedExpression.Internal.Pattern.html#~%2B"><span class="hs-operator">~+</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679262626"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262627"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262628"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Pattern.html#SumRestOp"><span class="hs-identifier hs-type">SumRestOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720324037410"><a href="HashedExpression.Internal.Pattern.html#~%2B"><span class="hs-operator">~+</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier hs-var">PSumRest</span></a><span> </span><a name="local-6989586621679262639"><a href="#local-6989586621679262639"><span class="hs-identifier">listCapture</span></a></a><span> </span><a name="local-6989586621679262640"><a href="#local-6989586621679262640"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262641"><a href="#local-6989586621679262641"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier hs-var">PSumRest</span></a><span> </span><a href="#local-6989586621679262639"><span class="hs-identifier hs-var">listCapture</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262640"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262641"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Pattern.html#SumRestOp"><span class="hs-identifier hs-type">SumRestOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720324037410"><a href="HashedExpression.Internal.Pattern.html#~%2B"><span class="hs-operator">~+</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262636"><a href="#local-6989586621679262636"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><a name="local-6989586621679262637"><a href="#local-6989586621679262637"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679262638"><a href="#local-6989586621679262638"><span class="hs-identifier">listHole</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679262636"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#~%2B"><span class="hs-operator hs-var">~+</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679262637"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262638"><span class="hs-identifier hs-var">listHole</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Pattern</span><span>
</span><a name="line-134"></a><span class="hs-comment">--</span><span>
</span><a name="line-135"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791537"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262632"><a href="#local-6989586621679262632"><span class="hs-identifier">wh1</span></a></a><span> </span><a name="local-6989586621679262633"><a href="#local-6989586621679262633"><span class="hs-identifier">wh2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSum"><span class="hs-identifier hs-var">PSum</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262632"><span class="hs-identifier hs-var">wh1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262633"><span class="hs-identifier hs-var">wh2</span></a><span class="hs-special">]</span><span>
</span><a name="line-137"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PNeg"><span class="hs-identifier hs-var">PNeg</span></a><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791536"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262634"><a href="#local-6989586621679262634"><span class="hs-identifier">wh1</span></a></a><span> </span><a name="local-6989586621679262635"><a href="#local-6989586621679262635"><span class="hs-identifier">wh2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMul"><span class="hs-identifier hs-var">PMul</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262634"><span class="hs-identifier hs-var">wh1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262635"><span class="hs-identifier hs-var">wh2</span></a><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791436"><span class="hs-operator">/</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PDiv"><span class="hs-identifier hs-var">PDiv</span></a><span>
</span><a name="line-142"></a><span>    </span><a name="local-3458764513820541090"><span class="hs-identifier">fromRational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Expression.html#VectorSpaceOp"><span class="hs-identifier hs-type">VectorSpaceOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-8214565720323821470"><a href="HashedExpression.Internal.Expression.html#scale"><span class="hs-identifier">scale</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PScale"><span class="hs-identifier hs-var">PScale</span></a><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>    </span><a name="local-8214565720323791286"><span class="hs-identifier">pi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><span class="hs-identifier hs-var">pi</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-8214565720323791283"><span class="hs-identifier">sqrt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSqrt"><span class="hs-identifier hs-var">PSqrt</span></a><span>
</span><a name="line-150"></a><span>    </span><a name="local-8214565720323791285"><span class="hs-identifier">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PExp"><span class="hs-identifier hs-var">PExp</span></a><span>
</span><a name="line-151"></a><span>    </span><a name="local-8214565720323791284"><span class="hs-identifier">log</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PLog"><span class="hs-identifier hs-var">PLog</span></a><span>
</span><a name="line-152"></a><span>    </span><a name="local-8214565720323791280"><span class="hs-identifier">sin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSin"><span class="hs-identifier hs-var">PSin</span></a><span>
</span><a name="line-153"></a><span>    </span><a name="local-8214565720323791279"><span class="hs-identifier">cos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PCos"><span class="hs-identifier hs-var">PCos</span></a><span>
</span><a name="line-154"></a><span>    </span><a name="local-8214565720323791278"><span class="hs-identifier">tan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTan"><span class="hs-identifier hs-var">PTan</span></a><span>
</span><a name="line-155"></a><span>    </span><a name="local-8214565720323791277"><span class="hs-identifier">asin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAsin"><span class="hs-identifier hs-var">PAsin</span></a><span>
</span><a name="line-156"></a><span>    </span><a name="local-8214565720323791276"><span class="hs-identifier">acos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAcos"><span class="hs-identifier hs-var">PAcos</span></a><span>
</span><a name="line-157"></a><span>    </span><a name="local-8214565720323791275"><span class="hs-identifier">atan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAtan"><span class="hs-identifier hs-var">PAtan</span></a><span>
</span><a name="line-158"></a><span>    </span><a name="local-8214565720323791274"><span class="hs-identifier">sinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSinh"><span class="hs-identifier hs-var">PSinh</span></a><span>
</span><a name="line-159"></a><span>    </span><a name="local-8214565720323791273"><span class="hs-identifier">cosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PCosh"><span class="hs-identifier hs-var">PCosh</span></a><span>
</span><a name="line-160"></a><span>    </span><a name="local-8214565720323791272"><span class="hs-identifier">tanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTanh"><span class="hs-identifier hs-var">PTanh</span></a><span>
</span><a name="line-161"></a><span>    </span><a name="local-8214565720323791271"><span class="hs-identifier">asinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAsinh"><span class="hs-identifier hs-var">PAsinh</span></a><span>
</span><a name="line-162"></a><span>    </span><a name="local-8214565720323791270"><span class="hs-identifier">acosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAcosh"><span class="hs-identifier hs-var">PAcosh</span></a><span>
</span><a name="line-163"></a><span>    </span><a name="local-8214565720323791269"><span class="hs-identifier">atanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAtanh"><span class="hs-identifier hs-var">PAtanh</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Expression.html#ComplexRealOp"><span class="hs-identifier hs-type">ComplexRealOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323821466"><a href="HashedExpression.Internal.Expression.html#%2B%3A"><span class="hs-operator">+:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRealImag"><span class="hs-identifier hs-var">PRealImag</span></a><span>
</span><a name="line-167"></a><span>    </span><a name="local-8214565720323821467"><a href="HashedExpression.Internal.Expression.html#xRe"><span class="hs-identifier">xRe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRealPart"><span class="hs-identifier hs-var">PRealPart</span></a><span>
</span><a name="line-168"></a><span>    </span><a name="local-8214565720323821468"><a href="HashedExpression.Internal.Expression.html#xIm"><span class="hs-identifier">xIm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PImagPart"><span class="hs-identifier hs-var">PImagPart</span></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Expression.html#InnerProductSpaceOp"><span class="hs-identifier hs-type">InnerProductSpaceOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323821464"><a href="HashedExpression.Internal.Expression.html#%3C.%3E"><span class="hs-operator">&lt;.&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PInnerProd"><span class="hs-identifier hs-var">PInnerProd</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Expression.html#PowerOp"><span class="hs-identifier hs-type">PowerOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323821473"><a href="HashedExpression.Internal.Expression.html#%5E"><span class="hs-operator">^</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPower"><span class="hs-identifier hs-var">PPower</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><a href="HashedExpression.Internal.Expression.html#RotateOp"><span class="hs-identifier hs-type">RotateOp</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><a name="local-8214565720323821462"><a href="HashedExpression.Internal.Expression.html#rotate"><span class="hs-identifier">rotate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRotate"><span class="hs-identifier hs-var">PRotate</span></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | Pattern List</span><span>
</span><a name="line-180"></a><span class="hs-comment">--</span><span>
</span><a name="line-181"></a><span class="hs-identifier">mapL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-182"></a><a name="mapL"><a href="HashedExpression.Internal.Pattern.html#mapL"><span class="hs-identifier">mapL</span></a></a><span> </span><a name="local-6989586621679262646"><a href="#local-6989586621679262646"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><a name="local-6989586621679262647"><a href="#local-6989586621679262647"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679262648"><a href="#local-6989586621679262648"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262646"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679262647"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262648"><span class="hs-identifier hs-var">listCapture</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Pattern Power</span><span>
</span><a name="line-185"></a><span class="hs-comment">--</span><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791537"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPowerMul"><span class="hs-identifier hs-var">PPowerMul</span></a><span>
</span><a name="line-188"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791536"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPowerMul"><span class="hs-identifier hs-var">PPowerMul</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | Pattern Rotate Amount</span><span>
</span><a name="line-191"></a><span class="hs-comment">--</span><span>
</span><a name="line-192"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323791537"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountSum"><span class="hs-identifier hs-var">PRotateAmountSum</span></a><span>
</span><a name="line-194"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountNegate"><span class="hs-identifier hs-var">PRotateAmountNegate</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Discrete fourier transform</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-identifier">reFT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-199"></a><a name="reFT"><a href="HashedExpression.Internal.Pattern.html#reFT"><span class="hs-identifier">reFT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PReFT"><span class="hs-identifier hs-var">PReFT</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-identifier">imFT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-202"></a><a name="imFT"><a href="HashedExpression.Internal.Pattern.html#imFT"><span class="hs-identifier">imFT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PImFT"><span class="hs-identifier hs-var">PImFT</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-identifier">twiceReFT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-205"></a><a name="twiceReFT"><a href="HashedExpression.Internal.Pattern.html#twiceReFT"><span class="hs-identifier">twiceReFT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTwiceReFT"><span class="hs-identifier hs-var">PTwiceReFT</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-identifier">twiceImFT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-208"></a><a name="twiceImFT"><a href="HashedExpression.Internal.Pattern.html#twiceImFT"><span class="hs-identifier">twiceImFT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTwiceImFT"><span class="hs-identifier hs-var">PTwiceImFT</span></a><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">-- | Guarded patterns for normalizier</span><span>
</span><a name="line-211"></a><span class="hs-comment">--</span><span>
</span><a name="line-212"></a><span class="hs-keyword">data</span><span> </span><a name="GuardedPattern"><a href="HashedExpression.Internal.Pattern.html#GuardedPattern"><span class="hs-identifier">GuardedPattern</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-213"></a><span>    </span><a name="GP"><a href="HashedExpression.Internal.Pattern.html#GP"><span class="hs-identifier">GP</span></a></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-keyword">type</span><span> </span><a name="Substitution"><a href="HashedExpression.Internal.Pattern.html#Substitution"><span class="hs-identifier">Substitution</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#GuardedPattern"><span class="hs-identifier hs-type">GuardedPattern</span></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- | Turn HashedPattern to a normalizier</span><span>
</span><a name="line-218"></a><span class="hs-comment">--</span><span>
</span><a name="line-219"></a><span class="hs-identifier">fromSubstitution</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-type">ExpressionDiff</span></a><span>
</span><a name="line-220"></a><a name="fromSubstitution"><a href="HashedExpression.Internal.Pattern.html#fromSubstitution"><span class="hs-identifier">fromSubstitution</span></a></a><span> </span><a name="local-6989586621679262649"><a href="#local-6989586621679262649"><span class="hs-identifier">pt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#GP"><span class="hs-identifier hs-var">GP</span></a><span> </span><a name="local-6989586621679262650"><a href="#local-6989586621679262650"><span class="hs-identifier">pattern</span></a></a><span> </span><a name="local-6989586621679262651"><a href="#local-6989586621679262651"><span class="hs-identifier">condition</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262652"><a href="#local-6989586621679262652"><span class="hs-identifier">replacementPattern</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262653"><a href="#local-6989586621679262653"><span class="hs-identifier">exp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679262654"><a href="#local-6989586621679262654"><span class="hs-identifier">mp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262655"><a href="#local-6989586621679262655"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262656"><a href="#local-6989586621679262656"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HashedExpression.Internal.Pattern.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262653"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262650"><span class="hs-identifier hs-var">pattern</span></a><span>
</span><a name="line-222"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262651"><span class="hs-identifier hs-var">condition</span></a><span> </span><a href="#local-6989586621679262653"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262656"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262653"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262656"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262652"><span class="hs-identifier hs-var">replacementPattern</span></a><span>
</span><a name="line-223"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Inner.html#noChange"><span class="hs-identifier hs-var">noChange</span></a><span> </span><a href="#local-6989586621679262655"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | Helper to make pattern and replacement without condition</span><span>
</span><a name="line-226"></a><span class="hs-comment">--</span><span>
</span><a name="line-227"></a><span class="hs-special">(</span><span class="hs-operator">|.~~~~~~&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-228"></a><span class="hs-special">(</span><a name="%7C.~~~~~~%3E"><a href="HashedExpression.Internal.Pattern.html#%7C.~~~~~~%3E"><span class="hs-operator">|.~~~~~~&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262657"><a href="#local-6989586621679262657"><span class="hs-identifier">pattern</span></a></a><span> </span><a name="local-6989586621679262658"><a href="#local-6989586621679262658"><span class="hs-identifier">replacement</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#GP"><span class="hs-identifier hs-var">GP</span></a><span> </span><a href="#local-6989586621679262657"><span class="hs-identifier hs-var">pattern</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Prelude.const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude.const</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262658"><span class="hs-identifier hs-var">replacement</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-keyword">infix</span><span> </span><span class="hs-number">0</span><span> </span><a href="HashedExpression.Internal.Pattern.html#%7C.~~~~~~%3E"><span class="hs-operator hs-var">|.~~~~~~&gt;</span></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#~~~~~~%3E"><span class="hs-operator hs-var">~~~~~~&gt;</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-special">(</span><span class="hs-operator">~~~~~~&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#GuardedPattern"><span class="hs-identifier hs-type">GuardedPattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-234"></a><span class="hs-special">(</span><a name="~~~~~~%3E"><a href="HashedExpression.Internal.Pattern.html#~~~~~~%3E"><span class="hs-operator">~~~~~~&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262659"><a href="#local-6989586621679262659"><span class="hs-identifier">gPattern</span></a></a><span> </span><a name="local-6989586621679262660"><a href="#local-6989586621679262660"><span class="hs-identifier">replacement</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262659"><span class="hs-identifier hs-var">gPattern</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262660"><span class="hs-identifier hs-var">replacement</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-special">(</span><span class="hs-operator">|.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#GuardedPattern"><span class="hs-identifier hs-type">GuardedPattern</span></a><span>
</span><a name="line-237"></a><span class="hs-special">(</span><a name="%7C."><a href="HashedExpression.Internal.Pattern.html#%7C."><span class="hs-operator">|.</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262661"><a href="#local-6989586621679262661"><span class="hs-identifier">pattern</span></a></a><span> </span><a name="local-6989586621679262662"><a href="#local-6989586621679262662"><span class="hs-identifier">condition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#GP"><span class="hs-identifier hs-var">GP</span></a><span> </span><a href="#local-6989586621679262661"><span class="hs-identifier hs-var">pattern</span></a><span> </span><a href="#local-6989586621679262662"><span class="hs-identifier hs-var">condition</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">1</span><span> </span><a href="HashedExpression.Internal.Pattern.html#%7C."><span class="hs-operator hs-var">|.</span></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-keyword">type</span><span> </span><a name="Condition"><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier">Condition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-244"></a><span class="hs-comment">--</span><span>
</span><a name="line-245"></a><span class="hs-special">(</span><span class="hs-operator">&amp;&amp;.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-246"></a><span class="hs-special">(</span><a name="%26%26."><a href="HashedExpression.Internal.Pattern.html#%26%26."><span class="hs-operator">&amp;&amp;.</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262663"><a href="#local-6989586621679262663"><span class="hs-identifier">condition1</span></a></a><span> </span><a name="local-6989586621679262664"><a href="#local-6989586621679262664"><span class="hs-identifier">condition2</span></a></a><span> </span><a name="local-6989586621679262665"><a href="#local-6989586621679262665"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679262666"><a href="#local-6989586621679262666"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-247"></a><span>    </span><a href="#local-6989586621679262663"><span class="hs-identifier hs-var">condition1</span></a><span> </span><a href="#local-6989586621679262665"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679262666"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679262664"><span class="hs-identifier hs-var">condition2</span></a><span> </span><a href="#local-6989586621679262665"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679262666"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-250"></a><span class="hs-comment">--</span><span>
</span><a name="line-251"></a><span class="hs-identifier">isNot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-252"></a><a name="isNot"><a href="HashedExpression.Internal.Pattern.html#isNot"><span class="hs-identifier">isNot</span></a></a><span> </span><a name="local-6989586621679262667"><a href="#local-6989586621679262667"><span class="hs-identifier">condition</span></a></a><span> </span><a name="local-6989586621679262668"><a href="#local-6989586621679262668"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679262669"><a href="#local-6989586621679262669"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262667"><span class="hs-identifier hs-var">condition</span></a><span> </span><a href="#local-6989586621679262668"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679262669"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">8</span><span> </span><a href="HashedExpression.Internal.Pattern.html#%26%26."><span class="hs-operator hs-var">&amp;&amp;.</span></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-257"></a><span class="hs-comment">--</span><span>
</span><a name="line-258"></a><span class="hs-special">(</span><span class="hs-operator">||.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-259"></a><span class="hs-special">(</span><a name="%7C%7C."><a href="HashedExpression.Internal.Pattern.html#%7C%7C."><span class="hs-operator">||.</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262670"><a href="#local-6989586621679262670"><span class="hs-identifier">condition1</span></a></a><span> </span><a name="local-6989586621679262671"><a href="#local-6989586621679262671"><span class="hs-identifier">condition2</span></a></a><span> </span><a name="local-6989586621679262672"><a href="#local-6989586621679262672"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679262673"><a href="#local-6989586621679262673"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-260"></a><span>    </span><a href="#local-6989586621679262670"><span class="hs-identifier hs-var">condition1</span></a><span> </span><a href="#local-6989586621679262672"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679262673"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679262671"><span class="hs-identifier hs-var">condition2</span></a><span> </span><a href="#local-6989586621679262672"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679262673"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-263"></a><span class="hs-comment">--</span><span>
</span><a name="line-264"></a><span class="hs-identifier">isScalar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-265"></a><a name="isScalar"><a href="HashedExpression.Internal.Pattern.html#isScalar"><span class="hs-identifier">isScalar</span></a></a><span> </span><a name="local-6989586621679262674"><a href="#local-6989586621679262674"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262675"><a href="#local-6989586621679262675"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262676"><a href="#local-6989586621679262676"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-266"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262677"><a href="#local-6989586621679262677"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262678"><a href="#local-6989586621679262678"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262675"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262676"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262674"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-267"></a><span>        </span><a name="local-6989586621679262679"><a href="#local-6989586621679262679"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262675"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-268"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveShape"><span class="hs-identifier hs-var">retrieveShape</span></a><span> </span><a href="#local-6989586621679262678"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262677"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262679"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-identifier">isConst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-273"></a><a name="isConst"><a href="HashedExpression.Internal.Pattern.html#isConst"><span class="hs-identifier">isConst</span></a></a><span> </span><a name="local-6989586621679262680"><a href="#local-6989586621679262680"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262681"><a href="#local-6989586621679262681"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262682"><a href="#local-6989586621679262682"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262683"><a href="#local-6989586621679262683"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262684"><a href="#local-6989586621679262684"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262681"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262682"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262680"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-275"></a><span>        </span><a name="local-6989586621679262685"><a href="#local-6989586621679262685"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262681"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-276"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveNode"><span class="hs-identifier hs-var">retrieveNode</span></a><span> </span><a href="#local-6989586621679262684"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262683"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262685"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-277"></a><span>            </span><a href="HashedExpression.Internal.Expression.html#Const"><span class="hs-identifier hs-var">Const</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-278"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-281"></a><span class="hs-comment">--</span><span>
</span><a name="line-282"></a><span class="hs-identifier">isNotConst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-283"></a><a name="isNotConst"><a href="HashedExpression.Internal.Pattern.html#isNotConst"><span class="hs-identifier">isNotConst</span></a></a><span> </span><a name="local-6989586621679262686"><a href="#local-6989586621679262686"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262687"><a href="#local-6989586621679262687"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262688"><a href="#local-6989586621679262688"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#isConst"><span class="hs-identifier hs-var">isConst</span></a><span> </span><a href="#local-6989586621679262686"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679262687"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262688"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-286"></a><span class="hs-comment">--</span><span>
</span><a name="line-287"></a><span class="hs-identifier">isReal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-288"></a><a name="isReal"><a href="HashedExpression.Internal.Pattern.html#isReal"><span class="hs-identifier">isReal</span></a></a><span> </span><a name="local-6989586621679262689"><a href="#local-6989586621679262689"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262690"><a href="#local-6989586621679262690"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262691"><a href="#local-6989586621679262691"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-289"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262692"><a href="#local-6989586621679262692"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262693"><a href="#local-6989586621679262693"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262690"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262691"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262689"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-290"></a><span>        </span><a name="local-6989586621679262694"><a href="#local-6989586621679262694"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262690"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-291"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveElementType"><span class="hs-identifier hs-var">retrieveElementType</span></a><span> </span><a href="#local-6989586621679262693"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262692"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262694"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="HashedExpression.Internal.Expression.html#R"><span class="hs-identifier hs-var">R</span></a><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-294"></a><span class="hs-comment">--</span><span>
</span><a name="line-295"></a><span class="hs-identifier">isComplex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-296"></a><a name="isComplex"><a href="HashedExpression.Internal.Pattern.html#isComplex"><span class="hs-identifier">isComplex</span></a></a><span> </span><a name="local-6989586621679262695"><a href="#local-6989586621679262695"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262696"><a href="#local-6989586621679262696"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262697"><a href="#local-6989586621679262697"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262698"><a href="#local-6989586621679262698"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262699"><a href="#local-6989586621679262699"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262696"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262697"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262695"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-298"></a><span>        </span><a name="local-6989586621679262700"><a href="#local-6989586621679262700"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262696"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-299"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveElementType"><span class="hs-identifier hs-var">retrieveElementType</span></a><span> </span><a href="#local-6989586621679262699"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262698"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262700"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="HashedExpression.Internal.Expression.html#C"><span class="hs-identifier hs-var">C</span></a><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-302"></a><span class="hs-comment">--</span><span>
</span><a name="line-303"></a><span class="hs-identifier">isCovector</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-304"></a><a name="isCovector"><a href="HashedExpression.Internal.Pattern.html#isCovector"><span class="hs-identifier">isCovector</span></a></a><span> </span><a name="local-6989586621679262701"><a href="#local-6989586621679262701"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262702"><a href="#local-6989586621679262702"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262703"><a href="#local-6989586621679262703"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-305"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262704"><a href="#local-6989586621679262704"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262705"><a href="#local-6989586621679262705"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262702"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262703"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262701"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-306"></a><span>        </span><a name="local-6989586621679262706"><a href="#local-6989586621679262706"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262702"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-307"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveElementType"><span class="hs-identifier hs-var">retrieveElementType</span></a><span> </span><a href="#local-6989586621679262705"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262704"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262706"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span>
</span><a name="line-308"></a><span>        </span><a href="HashedExpression.Internal.Expression.html#Covector"><span class="hs-identifier hs-var">Covector</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-311"></a><span class="hs-comment">--</span><span>
</span><a name="line-312"></a><span class="hs-identifier">sameElementType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-313"></a><a name="sameElementType"><a href="HashedExpression.Internal.Pattern.html#sameElementType"><span class="hs-identifier">sameElementType</span></a></a><span> </span><a name="local-6989586621679262707"><a href="#local-6989586621679262707"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679262708"><a href="#local-6989586621679262708"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262709"><a href="#local-6989586621679262709"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Utils.html#allEqual"><span class="hs-identifier hs-var">allEqual</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262710"><span class="hs-identifier hs-var">getET</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262707"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-314"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-315"></a><span>    </span><a name="local-6989586621679262710"><a href="#local-6989586621679262710"><span class="hs-identifier">getET</span></a></a><span> </span><a name="local-6989586621679262711"><a href="#local-6989586621679262711"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-316"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262712"><a href="#local-6989586621679262712"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262713"><a href="#local-6989586621679262713"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262708"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262709"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262711"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-317"></a><span>            </span><a name="local-6989586621679262714"><a href="#local-6989586621679262714"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262708"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-318"></a><span>         </span><span class="hs-keyword">in</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveElementType"><span class="hs-identifier hs-var">retrieveElementType</span></a><span> </span><a href="#local-6989586621679262713"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262712"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262714"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-321"></a><span class="hs-comment">--</span><span>
</span><a name="line-322"></a><span class="hs-identifier">allTheSame</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-323"></a><a name="allTheSame"><a href="HashedExpression.Internal.Pattern.html#allTheSame"><span class="hs-identifier">allTheSame</span></a></a><span> </span><a name="local-6989586621679262715"><a href="#local-6989586621679262715"><span class="hs-identifier">pl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262716"><a href="#local-6989586621679262716"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262717"><a href="#local-6989586621679262717"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262718"><a href="#local-6989586621679262718"><span class="hs-identifier">match</span></a></a><span>
</span><a name="line-324"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262719"><a href="#local-6989586621679262719"><span class="hs-identifier">nIds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262716"><span class="hs-identifier hs-var">listCapture</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">listCapturesMap</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262718"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-325"></a><span>        </span><a href="HashedExpression.Internal.Utils.html#allEqual"><span class="hs-identifier hs-var">allEqual</span></a><span> </span><a href="#local-6989586621679262719"><span class="hs-identifier hs-var">nIds</span></a><span>
</span><a name="line-326"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-329"></a><span class="hs-comment">--</span><span>
</span><a name="line-330"></a><span class="hs-identifier">isDVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-331"></a><a name="isDVar"><a href="HashedExpression.Internal.Pattern.html#isDVar"><span class="hs-identifier">isDVar</span></a></a><span> </span><a name="local-6989586621679262720"><a href="#local-6989586621679262720"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679262721"><a href="#local-6989586621679262721"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262722"><a href="#local-6989586621679262722"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-var">ExpressionDiff</span></a><span> </span><a name="local-6989586621679262723"><a href="#local-6989586621679262723"><span class="hs-identifier">extraEntries</span></a></a><span> </span><a name="local-6989586621679262724"><a href="#local-6989586621679262724"><span class="hs-identifier">newRootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262721"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262722"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262720"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-333"></a><span>        </span><a name="local-6989586621679262725"><a href="#local-6989586621679262725"><span class="hs-identifier">originMp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679262721"><span class="hs-identifier hs-var">exp</span></a><span>
</span><a name="line-334"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HashedExpression.Internal.Node.html#retrieveNode"><span class="hs-identifier hs-var">retrieveNode</span></a><span> </span><a href="#local-6989586621679262724"><span class="hs-identifier hs-var">newRootId</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IM.union</span><span> </span><a href="#local-6989586621679262723"><span class="hs-identifier hs-var">extraEntries</span></a><span> </span><a href="#local-6989586621679262725"><span class="hs-identifier hs-var">originMp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-335"></a><span>            </span><a href="HashedExpression.Internal.Expression.html#DVar"><span class="hs-identifier hs-var">DVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-336"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-339"></a><span class="hs-comment">--</span><span>
</span><a name="line-340"></a><span class="hs-identifier">zeroAmount</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-341"></a><a name="zeroAmount"><a href="HashedExpression.Internal.Pattern.html#zeroAmount"><span class="hs-identifier">zeroAmount</span></a></a><span> </span><a name="local-6989586621679262726"><a href="#local-6989586621679262726"><span class="hs-identifier">pra</span></a></a><span> </span><a name="local-6989586621679262727"><a href="#local-6989586621679262727"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262728"><a href="#local-6989586621679262728"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-342"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262729"><a href="#local-6989586621679262729"><span class="hs-identifier">rotateAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262728"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262726"><span class="hs-identifier hs-var">pra</span></a><span>
</span><a name="line-343"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262729"><span class="hs-identifier hs-var">rotateAmount</span></a><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-346"></a><span class="hs-comment">--</span><span>
</span><a name="line-347"></a><span class="hs-identifier">sameAmount</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-348"></a><a name="sameAmount"><a href="HashedExpression.Internal.Pattern.html#sameAmount"><span class="hs-identifier">sameAmount</span></a></a><span> </span><a name="local-6989586621679262730"><a href="#local-6989586621679262730"><span class="hs-identifier">pra1</span></a></a><span> </span><a name="local-6989586621679262731"><a href="#local-6989586621679262731"><span class="hs-identifier">pra2</span></a></a><span> </span><a name="local-6989586621679262732"><a href="#local-6989586621679262732"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262733"><a href="#local-6989586621679262733"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-349"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262734"><a href="#local-6989586621679262734"><span class="hs-identifier">rotateAmount1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262733"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262730"><span class="hs-identifier hs-var">pra1</span></a><span>
</span><a name="line-350"></a><span>        </span><a name="local-6989586621679262735"><a href="#local-6989586621679262735"><span class="hs-identifier">rotateAmount2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262733"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262731"><span class="hs-identifier hs-var">pra2</span></a><span>
</span><a name="line-351"></a><span>     </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679262734"><span class="hs-identifier hs-var">rotateAmount1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679262735"><span class="hs-identifier hs-var">rotateAmount2</span></a><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-354"></a><span class="hs-comment">--</span><span>
</span><a name="line-355"></a><span class="hs-special">[</span><a name="local-8214565720324037492"><a href="HashedExpression.Internal.Pattern.html#p"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037493"><a href="HashedExpression.Internal.Pattern.html#q"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037494"><a href="HashedExpression.Internal.Pattern.html#r"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037495"><a href="HashedExpression.Internal.Pattern.html#s"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037496"><a href="HashedExpression.Internal.Pattern.html#t"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037497"><a href="HashedExpression.Internal.Pattern.html#u"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037498"><a href="HashedExpression.Internal.Pattern.html#v"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037499"><a href="HashedExpression.Internal.Pattern.html#w"><span class="hs-identifier">w</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037500"><a href="HashedExpression.Internal.Pattern.html#x"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037501"><a href="HashedExpression.Internal.Pattern.html#y"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037502"><a href="HashedExpression.Internal.Pattern.html#z"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037503"><a href="HashedExpression.Internal.Pattern.html#condition"><span class="hs-identifier">condition</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PHole"><span class="hs-identifier hs-var">PHole</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">12</span><span class="hs-special">]</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-identifier">one</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-358"></a><a name="one"><a href="HashedExpression.Internal.Pattern.html#one"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">zero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-361"></a><a name="zero"><a href="HashedExpression.Internal.Pattern.html#zero"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-identifier">powerOne</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span>
</span><a name="line-364"></a><a name="powerOne"><a href="HashedExpression.Internal.Pattern.html#powerOne"><span class="hs-identifier">powerOne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPowerConst"><span class="hs-identifier hs-var">PPowerConst</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-identifier">powerZero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span>
</span><a name="line-367"></a><a name="powerZero"><a href="HashedExpression.Internal.Pattern.html#powerZero"><span class="hs-identifier">powerZero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPowerConst"><span class="hs-identifier hs-var">PPowerConst</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span class="hs-special">[</span><a name="local-8214565720324037508"><a href="HashedExpression.Internal.Pattern.html#alpha"><span class="hs-identifier">alpha</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037509"><a href="HashedExpression.Internal.Pattern.html#beta"><span class="hs-identifier">beta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037510"><a href="HashedExpression.Internal.Pattern.html#gamma"><span class="hs-identifier">gamma</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPowerHole"><span class="hs-identifier hs-var">PPowerHole</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">3</span><span class="hs-special">]</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-identifier">scalarOne</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-372"></a><a name="scalarOne"><a href="HashedExpression.Internal.Pattern.html#scalarOne"><span class="hs-identifier">scalarOne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PScalarConst"><span class="hs-identifier hs-var">PScalarConst</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-identifier">scalarZero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-375"></a><a name="scalarZero"><a href="HashedExpression.Internal.Pattern.html#scalarZero"><span class="hs-identifier">scalarZero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PScalarConst"><span class="hs-identifier hs-var">PScalarConst</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-identifier">scalar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-378"></a><a name="scalar"><a href="HashedExpression.Internal.Pattern.html#scalar"><span class="hs-identifier">scalar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PScalarConst"><span class="hs-identifier hs-var">PScalarConst</span></a><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">num</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-381"></a><a name="num"><a href="HashedExpression.Internal.Pattern.html#num"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-384"></a><span class="hs-comment">--</span><span>
</span><a name="line-385"></a><span class="hs-identifier">ys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-386"></a><a name="ys"><a href="HashedExpression.Internal.Pattern.html#ys"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-389"></a><a name="xs"><a href="HashedExpression.Internal.Pattern.html#xs"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-identifier">sum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-392"></a><a name="sum"><a href="HashedExpression.Internal.Pattern.html#sum"><span class="hs-identifier">sum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSumList"><span class="hs-identifier hs-var">PSumList</span></a><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-identifier">product</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-395"></a><a name="product"><a href="HashedExpression.Internal.Pattern.html#product"><span class="hs-identifier">product</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMulList"><span class="hs-identifier hs-var">PMulList</span></a><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-398"></a><span class="hs-comment">--</span><span>
</span><a name="line-399"></a><span class="hs-identifier">piecewise_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-400"></a><a name="piecewise_"><a href="HashedExpression.Internal.Pattern.html#piecewise_"><span class="hs-identifier">piecewise_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPiecewise"><span class="hs-identifier hs-var">PPiecewise</span></a><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span class="hs-identifier">branches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span>
</span><a name="line-403"></a><a name="branches"><a href="HashedExpression.Internal.Pattern.html#branches"><span class="hs-identifier">branches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-identifier">headL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-406"></a><a name="headL"><a href="HashedExpression.Internal.Pattern.html#headL"><span class="hs-identifier">headL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PHead"><span class="hs-identifier hs-var">PHead</span></a><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-409"></a><span class="hs-comment">--</span><span>
</span><a name="line-410"></a><span class="hs-identifier">restOfProduct</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-411"></a><a name="restOfProduct"><a href="HashedExpression.Internal.Pattern.html#restOfProduct"><span class="hs-identifier">restOfProduct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier hs-var">PMulRest</span></a><span> </span><span class="hs-number">239</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-identifier">restOfSum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-414"></a><a name="restOfSum"><a href="HashedExpression.Internal.Pattern.html#restOfSum"><span class="hs-identifier">restOfSum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier hs-var">PSumRest</span></a><span> </span><span class="hs-number">2391</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-417"></a><span class="hs-comment">--</span><span>
</span><a name="line-418"></a><span class="hs-special">[</span><a name="local-8214565720324037524"><a href="HashedExpression.Internal.Pattern.html#amount"><span class="hs-identifier">amount</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037525"><a href="HashedExpression.Internal.Pattern.html#amount1"><span class="hs-identifier">amount1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037526"><a href="HashedExpression.Internal.Pattern.html#amount2"><span class="hs-identifier">amount2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720324037527"><a href="HashedExpression.Internal.Pattern.html#amount3"><span class="hs-identifier">amount3</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountHole"><span class="hs-identifier hs-var">PRotateAmountHole</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">4</span><span class="hs-special">]</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- | Matches all nodes in the expression to see if they all match the PatternList, if they match, return</span><span>
</span><a name="line-421"></a><span class="hs-comment">-- the inner actual nodes</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- e.g: matchList [a + (b * x), a + (b * y), a + (b * z)] (PatternList: (a + (b * _)) ---&gt; Just [x, y, z]</span><span>
</span><a name="line-423"></a><span class="hs-comment">--      matchList [x, y, z, t] (PatternList: (_)) = Just [x, y, z, t]</span><span>
</span><a name="line-424"></a><span class="hs-comment">--      matchList [1 + x, 2 + x, y + x] (PatternList: (a + _)) = Nothing (not the same for all)</span><span>
</span><a name="line-425"></a><span class="hs-comment">--</span><span>
</span><a name="line-426"></a><span class="hs-identifier">matchList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span>
</span><a name="line-427"></a><a name="matchList"><a href="HashedExpression.Internal.Pattern.html#matchList"><span class="hs-identifier">matchList</span></a></a><span> </span><a name="local-6989586621679262736"><a href="#local-6989586621679262736"><span class="hs-identifier">mp</span></a></a><span> </span><a name="local-6989586621679262737"><a href="#local-6989586621679262737"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><a name="local-6989586621679262738"><a href="#local-6989586621679262738"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679262739"><a href="#local-6989586621679262739"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679262744"><span class="hs-identifier hs-var">maybeSubMatches</span></a><span>
</span><a name="line-429"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262749"><a href="#local-6989586621679262749"><span class="hs-identifier">subMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><a href="#local-6989586621679262744"><span class="hs-identifier hs-var">maybeSubMatches</span></a><span>
</span><a name="line-430"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262750"><a href="#local-6989586621679262750"><span class="hs-identifier">unionSubMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262749"><span class="hs-identifier hs-var">subMatches</span></a><span>
</span><a name="line-431"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Utils.html#allEqual"><span class="hs-identifier hs-var">allEqual</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262745"><span class="hs-identifier hs-var">otherCaptures</span></a><span> </span><a href="#local-6989586621679262749"><span class="hs-identifier hs-var">subMatches</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-432"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-433"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262750"><span class="hs-identifier hs-var">unionSubMatches</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-434"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-435"></a><span>            </span><span class="hs-special">{</span><span class="hs-identifier">listCapturesMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262739"><span class="hs-identifier hs-var">listCapture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262746"><span class="hs-identifier hs-var">nIds</span></a><span> </span><a href="#local-6989586621679262749"><span class="hs-identifier hs-var">subMatches</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-437"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-438"></a><span>    </span><a name="local-6989586621679262740"><a href="#local-6989586621679262740"><span class="hs-identifier">uniqueCapture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-439"></a><span>    </span><a name="local-6989586621679262741"><a href="#local-6989586621679262741"><span class="hs-identifier">eachHole</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PHole"><span class="hs-identifier hs-var">PHole</span></a><span> </span><a href="#local-6989586621679262740"><span class="hs-identifier hs-var">uniqueCapture</span></a><span>
</span><a name="line-440"></a><span>    </span><a name="local-6989586621679262742"><a href="#local-6989586621679262742"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679262738"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621679262741"><span class="hs-identifier hs-var">eachHole</span></a><span>
</span><a name="line-441"></a><span>    </span><a name="local-6989586621679262743"><a href="#local-6989586621679262743"><span class="hs-identifier">matchOne</span></a></a><span> </span><a name="local-6989586621679262747"><a href="#local-6989586621679262747"><span class="hs-identifier">nId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262736"><span class="hs-identifier hs-var">mp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262747"><span class="hs-identifier hs-var">nId</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262742"><span class="hs-identifier hs-var">pt</span></a><span>
</span><a name="line-442"></a><span>    </span><a name="local-6989586621679262744"><a href="#local-6989586621679262744"><span class="hs-identifier">maybeSubMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262743"><span class="hs-identifier hs-var">matchOne</span></a><span> </span><a href="#local-6989586621679262737"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-443"></a><span>    </span><a name="local-6989586621679262745"><a href="#local-6989586621679262745"><span class="hs-identifier">otherCaptures</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.delete</span><span> </span><a href="#local-6989586621679262740"><span class="hs-identifier hs-var">uniqueCapture</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">capturesMap</span><span>
</span><a name="line-444"></a><span>    </span><a name="local-6989586621679262746"><a href="#local-6989586621679262746"><span class="hs-identifier">nIds</span></a></a><span> </span><a name="local-6989586621679262748"><a href="#local-6989586621679262748"><span class="hs-identifier">subMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-445"></a><span>        </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262740"><span class="hs-identifier hs-var">uniqueCapture</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">capturesMap</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262748"><span class="hs-identifier hs-var">subMatches</span></a><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-comment">-- | Match is the result we get when match an Expression against a Pattern</span><span>
</span><a name="line-448"></a><span class="hs-comment">--</span><span>
</span><a name="line-449"></a><span class="hs-keyword">type</span><span> </span><a name="NodeId"><a href="HashedExpression.Internal.Pattern.html#NodeId"><span class="hs-identifier">NodeId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-keyword">type</span><span> </span><a name="PowerValue"><a href="HashedExpression.Internal.Pattern.html#PowerValue"><span class="hs-identifier">PowerValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-keyword">data</span><span> </span><a name="Match"><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier">Match</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-454"></a><span>    </span><a name="Match"><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier">Match</span></a></a><span>
</span><a name="line-455"></a><span>        </span><span class="hs-special">{</span><span> </span><a name="capturesMap"><a href="HashedExpression.Internal.Pattern.html#capturesMap"><span class="hs-identifier">capturesMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Capture"><span class="hs-identifier hs-type">Capture</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span> </span><span class="hs-comment">-- A given capture corresponds to a node id</span><span>
</span><a name="line-456"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="listCapturesMap"><a href="HashedExpression.Internal.Pattern.html#listCapturesMap"><span class="hs-identifier">listCapturesMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#ListCapture"><span class="hs-identifier hs-type">ListCapture</span></a><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#NodeId"><span class="hs-identifier hs-type">NodeId</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- A given list capture corresponds to a list of node ids</span><span>
</span><a name="line-457"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="powerCapturesMap"><a href="HashedExpression.Internal.Pattern.html#powerCapturesMap"><span class="hs-identifier">powerCapturesMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PowerCapture"><span class="hs-identifier hs-type">PowerCapture</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#PowerValue"><span class="hs-identifier hs-type">PowerValue</span></a><span> </span><span class="hs-comment">-- A given power capture corresponds to a power value</span><span>
</span><a name="line-458"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="rotateAmountCapturesMap"><a href="HashedExpression.Internal.Pattern.html#rotateAmountCapturesMap"><span class="hs-identifier">rotateAmountCapturesMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="HashedExpression.Internal.Pattern.html#RotateAmountCapture"><span class="hs-identifier hs-type">RotateAmountCapture</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#RotateAmount"><span class="hs-identifier hs-type">RotateAmount</span></a><span> </span><span class="hs-comment">-- A given rotate amount capture corresponds to a rotate amount</span><span>
</span><a name="line-459"></a><span>        </span><span class="hs-special">}</span><span>
</span><a name="line-460"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-identifier">emptyMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span>
</span><a name="line-463"></a><a name="emptyMatch"><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier">emptyMatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-identifier">unionMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span>
</span><a name="line-466"></a><a name="unionMatch"><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier">unionMatch</span></a></a><span> </span><a name="local-6989586621679262751"><a href="#local-6989586621679262751"><span class="hs-identifier">match1</span></a></a><span> </span><a name="local-6989586621679262752"><a href="#local-6989586621679262752"><span class="hs-identifier">match2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-467"></a><span>    </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-var">Match</span></a><span>
</span><a name="line-468"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">capturesMap</span><span> </span><a href="#local-6989586621679262751"><span class="hs-identifier hs-var">match1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">capturesMap</span><span> </span><a href="#local-6989586621679262752"><span class="hs-identifier hs-var">match2</span></a><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">listCapturesMap</span><span> </span><a href="#local-6989586621679262751"><span class="hs-identifier hs-var">match1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">listCapturesMap</span><span> </span><a href="#local-6989586621679262752"><span class="hs-identifier hs-var">match2</span></a><span class="hs-special">)</span><span>
</span><a name="line-470"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">powerCapturesMap</span><span> </span><a href="#local-6989586621679262751"><span class="hs-identifier hs-var">match1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">powerCapturesMap</span><span> </span><a href="#local-6989586621679262752"><span class="hs-identifier hs-var">match2</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">rotateAmountCapturesMap</span><span> </span><a href="#local-6989586621679262751"><span class="hs-identifier hs-var">match1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rotateAmountCapturesMap</span><span> </span><a href="#local-6989586621679262752"><span class="hs-identifier hs-var">match2</span></a><span class="hs-special">)</span><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span class="hs-comment">-- | Match an expression with a pattern, return the map between capture hole to the actual node</span><span>
</span><a name="line-474"></a><span class="hs-comment">-- e.g: match (Expression: (a(3243) + b(32521)) (PatternNormal:(x(1) + y(2)) --&gt; ({1 -&gt; 3243, 2 -&gt; 32521}, {})</span><span>
</span><a name="line-475"></a><span class="hs-comment">--      match (Expression sum(a(3243), b(32521), c(21321)) (PatternNormal:(sum(each(1))) --&gt; ({}, {1 -&gt; [3243, 32521, 21321]})</span><span>
</span><a name="line-476"></a><span class="hs-identifier">match</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span>
</span><a name="line-477"></a><a name="match"><a href="HashedExpression.Internal.Pattern.html#match"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679262753"><a href="#local-6989586621679262753"><span class="hs-identifier">mp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262754"><a href="#local-6989586621679262754"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262755"><a href="#local-6989586621679262755"><span class="hs-identifier">outerWH</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262756"><a href="#local-6989586621679262756"><span class="hs-identifier">unionBoth</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679262759"><a href="#local-6989586621679262759"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262760"><a href="#local-6989586621679262760"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679262761"><a href="#local-6989586621679262761"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262762"><a href="#local-6989586621679262762"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262759"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679262761"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262760"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">union</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679262762"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>        </span><a name="local-6989586621679262757"><a href="#local-6989586621679262757"><span class="hs-identifier">catMatch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-480"></a><span>        </span><span class="hs-identifier">recursiveAndCombine</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Expression.html#Arg"><span class="hs-identifier hs-type">Arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span>
</span><a name="line-481"></a><span>        </span><a name="local-6989586621679262758"><a href="#local-6989586621679262758"><span class="hs-identifier">recursiveAndCombine</span></a></a><span> </span><a name="local-6989586621679262763"><a href="#local-6989586621679262763"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679262764"><a href="#local-6989586621679262764"><span class="hs-identifier">whs</span></a></a><span>
</span><a name="line-482"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262763"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262764"><span class="hs-identifier hs-var">whs</span></a><span>
</span><a name="line-483"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262765"><a href="#local-6989586621679262765"><span class="hs-identifier">subMatches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="HashedExpression.Internal.Pattern.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262753"><span class="hs-identifier hs-var">mp</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262763"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262764"><span class="hs-identifier hs-var">whs</span></a><span>
</span><a name="line-484"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679262765"><span class="hs-identifier hs-var">subMatches</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679262757"><span class="hs-identifier hs-var">catMatch</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262765"><span class="hs-identifier hs-var">subMatches</span></a><span>
</span><a name="line-485"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-486"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Node.html#retrieveNode"><span class="hs-identifier hs-var">retrieveNode</span></a><span> </span><a href="#local-6989586621679262754"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679262753"><span class="hs-identifier hs-var">mp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262755"><span class="hs-identifier hs-var">outerWH</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-487"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PHole"><span class="hs-identifier hs-var">PHole</span></a><span> </span><a name="local-6989586621679262766"><a href="#local-6989586621679262766"><span class="hs-identifier">capture</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-488"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">capturesMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262766"><span class="hs-identifier hs-var">capture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262754"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-489"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Const"><span class="hs-identifier hs-var">Const</span></a><span> </span><a name="local-6989586621679262767"><a href="#local-6989586621679262767"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><a name="local-6989586621679262768"><a href="#local-6989586621679262768"><span class="hs-identifier">whc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679262767"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679262768"><span class="hs-identifier hs-var">whc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-491"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262769"><a href="#local-6989586621679262769"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSum"><span class="hs-identifier hs-var">PSum</span></a><span> </span><a name="local-6989586621679262770"><a href="#local-6989586621679262770"><span class="hs-identifier">whs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><a href="#local-6989586621679262769"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679262770"><span class="hs-identifier hs-var">whs</span></a><span>
</span><a name="line-492"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262771"><a href="#local-6989586621679262771"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSumList"><span class="hs-identifier hs-var">PSumList</span></a><span> </span><a name="local-6989586621679262772"><a href="#local-6989586621679262772"><span class="hs-identifier">pl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262773"><a href="#local-6989586621679262773"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-493"></a><span>                </span><a href="HashedExpression.Internal.Pattern.html#matchList"><span class="hs-identifier hs-var">matchList</span></a><span> </span><a href="#local-6989586621679262753"><span class="hs-identifier hs-var">mp</span></a><span> </span><a href="#local-6989586621679262771"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679262772"><span class="hs-identifier hs-var">pl</span></a><span>
</span><a name="line-494"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262774"><a href="#local-6989586621679262774"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier hs-var">PSumRest</span></a><span> </span><a name="local-6989586621679262775"><a href="#local-6989586621679262775"><span class="hs-identifier">listCapture</span></a></a><span> </span><a name="local-6989586621679262776"><a href="#local-6989586621679262776"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-495"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262774"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262776"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-496"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679262777"><a href="#local-6989586621679262777"><span class="hs-identifier">rest</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262778"><a href="#local-6989586621679262778"><span class="hs-identifier">normalParts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-497"></a><span>                          </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262774"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262776"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262774"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-498"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262778"><span class="hs-identifier hs-var">normalParts</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262776"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-499"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262779"><a href="#local-6989586621679262779"><span class="hs-identifier">matchNormalParts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><a href="#local-6989586621679262778"><span class="hs-identifier hs-var">normalParts</span></a><span> </span><a href="#local-6989586621679262776"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-500"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262780"><a href="#local-6989586621679262780"><span class="hs-identifier">matchListPart</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-501"></a><span>                          </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-502"></a><span>                              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">listCapturesMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-503"></a><span>                                    </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262775"><span class="hs-identifier hs-var">listCapture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262777"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-504"></a><span>                              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-505"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262779"><span class="hs-identifier hs-var">matchNormalParts</span></a><span> </span><a href="#local-6989586621679262780"><span class="hs-identifier hs-var">matchListPart</span></a><span>
</span><a name="line-506"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Mul"><span class="hs-identifier hs-var">Mul</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262781"><a href="#local-6989586621679262781"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMul"><span class="hs-identifier hs-var">PMul</span></a><span> </span><a name="local-6989586621679262782"><a href="#local-6989586621679262782"><span class="hs-identifier">whs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><a href="#local-6989586621679262781"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679262782"><span class="hs-identifier hs-var">whs</span></a><span>
</span><a name="line-507"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Mul"><span class="hs-identifier hs-var">Mul</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262783"><a href="#local-6989586621679262783"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMulList"><span class="hs-identifier hs-var">PMulList</span></a><span> </span><a name="local-6989586621679262784"><a href="#local-6989586621679262784"><span class="hs-identifier">pl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262785"><a href="#local-6989586621679262785"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-508"></a><span>                </span><a href="HashedExpression.Internal.Pattern.html#matchList"><span class="hs-identifier hs-var">matchList</span></a><span> </span><a href="#local-6989586621679262753"><span class="hs-identifier hs-var">mp</span></a><span> </span><a href="#local-6989586621679262783"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679262784"><span class="hs-identifier hs-var">pl</span></a><span>
</span><a name="line-509"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Mul"><span class="hs-identifier hs-var">Mul</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262786"><a href="#local-6989586621679262786"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier hs-var">PMulRest</span></a><span> </span><a name="local-6989586621679262787"><a href="#local-6989586621679262787"><span class="hs-identifier">listCapture</span></a></a><span> </span><a name="local-6989586621679262788"><a href="#local-6989586621679262788"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262786"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262788"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-511"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679262789"><a href="#local-6989586621679262789"><span class="hs-identifier">rest</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262790"><a href="#local-6989586621679262790"><span class="hs-identifier">normalParts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-512"></a><span>                          </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262786"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262788"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262786"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-513"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262790"><span class="hs-identifier hs-var">normalParts</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679262788"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-514"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262791"><a href="#local-6989586621679262791"><span class="hs-identifier">matchNormalParts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><a href="#local-6989586621679262790"><span class="hs-identifier hs-var">normalParts</span></a><span> </span><a href="#local-6989586621679262788"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-515"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262792"><a href="#local-6989586621679262792"><span class="hs-identifier">matchListPart</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-516"></a><span>                          </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-517"></a><span>                              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">listCapturesMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-518"></a><span>                                    </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262787"><span class="hs-identifier hs-var">listCapture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262789"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-519"></a><span>                              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-520"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262791"><span class="hs-identifier hs-var">matchNormalParts</span></a><span> </span><a href="#local-6989586621679262792"><span class="hs-identifier hs-var">matchListPart</span></a><span>
</span><a name="line-521"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262793"><a href="#local-6989586621679262793"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PNeg"><span class="hs-identifier hs-var">PNeg</span></a><span> </span><a name="local-6989586621679262794"><a href="#local-6989586621679262794"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262793"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262794"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-522"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Scale"><span class="hs-identifier hs-var">Scale</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262795"><a href="#local-6989586621679262795"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621679262796"><a href="#local-6989586621679262796"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PScale"><span class="hs-identifier hs-var">PScale</span></a><span> </span><a name="local-6989586621679262797"><a href="#local-6989586621679262797"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262798"><a href="#local-6989586621679262798"><span class="hs-identifier">sp2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-523"></a><span>                </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262795"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262796"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262797"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262798"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-524"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Div"><span class="hs-identifier hs-var">Div</span></a><span> </span><a name="local-6989586621679262799"><a href="#local-6989586621679262799"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621679262800"><a href="#local-6989586621679262800"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PDiv"><span class="hs-identifier hs-var">PDiv</span></a><span> </span><a name="local-6989586621679262801"><a href="#local-6989586621679262801"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262802"><a href="#local-6989586621679262802"><span class="hs-identifier">sp2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-525"></a><span>                </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262799"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262800"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262801"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262802"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sqrt"><span class="hs-identifier hs-var">Sqrt</span></a><span> </span><a name="local-6989586621679262803"><a href="#local-6989586621679262803"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSqrt"><span class="hs-identifier hs-var">PSqrt</span></a><span> </span><a name="local-6989586621679262804"><a href="#local-6989586621679262804"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262803"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262804"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-527"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sin"><span class="hs-identifier hs-var">Sin</span></a><span> </span><a name="local-6989586621679262805"><a href="#local-6989586621679262805"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSin"><span class="hs-identifier hs-var">PSin</span></a><span> </span><a name="local-6989586621679262806"><a href="#local-6989586621679262806"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262805"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262806"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-528"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Cos"><span class="hs-identifier hs-var">Cos</span></a><span> </span><a name="local-6989586621679262807"><a href="#local-6989586621679262807"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PCos"><span class="hs-identifier hs-var">PCos</span></a><span> </span><a name="local-6989586621679262808"><a href="#local-6989586621679262808"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262807"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262808"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-529"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Tan"><span class="hs-identifier hs-var">Tan</span></a><span> </span><a name="local-6989586621679262809"><a href="#local-6989586621679262809"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTan"><span class="hs-identifier hs-var">PTan</span></a><span> </span><a name="local-6989586621679262810"><a href="#local-6989586621679262810"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262809"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262810"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-530"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a name="local-6989586621679262811"><a href="#local-6989586621679262811"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PExp"><span class="hs-identifier hs-var">PExp</span></a><span> </span><a name="local-6989586621679262812"><a href="#local-6989586621679262812"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262811"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262812"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-531"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Log"><span class="hs-identifier hs-var">Log</span></a><span> </span><a name="local-6989586621679262813"><a href="#local-6989586621679262813"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PLog"><span class="hs-identifier hs-var">PLog</span></a><span> </span><a name="local-6989586621679262814"><a href="#local-6989586621679262814"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262813"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262814"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-532"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Sinh"><span class="hs-identifier hs-var">Sinh</span></a><span> </span><a name="local-6989586621679262815"><a href="#local-6989586621679262815"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PSinh"><span class="hs-identifier hs-var">PSinh</span></a><span> </span><a name="local-6989586621679262816"><a href="#local-6989586621679262816"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262815"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262816"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-533"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Cosh"><span class="hs-identifier hs-var">Cosh</span></a><span> </span><a name="local-6989586621679262817"><a href="#local-6989586621679262817"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PCosh"><span class="hs-identifier hs-var">PCosh</span></a><span> </span><a name="local-6989586621679262818"><a href="#local-6989586621679262818"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262817"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262818"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-534"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Tanh"><span class="hs-identifier hs-var">Tanh</span></a><span> </span><a name="local-6989586621679262819"><a href="#local-6989586621679262819"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTanh"><span class="hs-identifier hs-var">PTanh</span></a><span> </span><a name="local-6989586621679262820"><a href="#local-6989586621679262820"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262819"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262820"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-535"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Asin"><span class="hs-identifier hs-var">Asin</span></a><span> </span><a name="local-6989586621679262821"><a href="#local-6989586621679262821"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAsin"><span class="hs-identifier hs-var">PAsin</span></a><span> </span><a name="local-6989586621679262822"><a href="#local-6989586621679262822"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262821"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262822"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-536"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Acos"><span class="hs-identifier hs-var">Acos</span></a><span> </span><a name="local-6989586621679262823"><a href="#local-6989586621679262823"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAcos"><span class="hs-identifier hs-var">PAcos</span></a><span> </span><a name="local-6989586621679262824"><a href="#local-6989586621679262824"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262823"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262824"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-537"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Atan"><span class="hs-identifier hs-var">Atan</span></a><span> </span><a name="local-6989586621679262825"><a href="#local-6989586621679262825"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAtan"><span class="hs-identifier hs-var">PAtan</span></a><span> </span><a name="local-6989586621679262826"><a href="#local-6989586621679262826"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262825"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262826"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-538"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Asinh"><span class="hs-identifier hs-var">Asinh</span></a><span> </span><a name="local-6989586621679262827"><a href="#local-6989586621679262827"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAsinh"><span class="hs-identifier hs-var">PAsinh</span></a><span> </span><a name="local-6989586621679262828"><a href="#local-6989586621679262828"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262827"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262828"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-539"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Acosh"><span class="hs-identifier hs-var">Acosh</span></a><span> </span><a name="local-6989586621679262829"><a href="#local-6989586621679262829"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAcosh"><span class="hs-identifier hs-var">PAcosh</span></a><span> </span><a name="local-6989586621679262830"><a href="#local-6989586621679262830"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262829"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262830"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-540"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Atanh"><span class="hs-identifier hs-var">Atanh</span></a><span> </span><a name="local-6989586621679262831"><a href="#local-6989586621679262831"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PAtanh"><span class="hs-identifier hs-var">PAtanh</span></a><span> </span><a name="local-6989586621679262832"><a href="#local-6989586621679262832"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262831"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262832"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-541"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#RealImag"><span class="hs-identifier hs-var">RealImag</span></a><span> </span><a name="local-6989586621679262833"><a href="#local-6989586621679262833"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621679262834"><a href="#local-6989586621679262834"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRealImag"><span class="hs-identifier hs-var">PRealImag</span></a><span> </span><a name="local-6989586621679262835"><a href="#local-6989586621679262835"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262836"><a href="#local-6989586621679262836"><span class="hs-identifier">sp2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-542"></a><span>                </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262833"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262834"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262835"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262836"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-543"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#RealPart"><span class="hs-identifier hs-var">RealPart</span></a><span> </span><a name="local-6989586621679262837"><a href="#local-6989586621679262837"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRealPart"><span class="hs-identifier hs-var">PRealPart</span></a><span> </span><a name="local-6989586621679262838"><a href="#local-6989586621679262838"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262837"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262838"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-544"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ImagPart"><span class="hs-identifier hs-var">ImagPart</span></a><span> </span><a name="local-6989586621679262839"><a href="#local-6989586621679262839"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PImagPart"><span class="hs-identifier hs-var">PImagPart</span></a><span> </span><a name="local-6989586621679262840"><a href="#local-6989586621679262840"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262839"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262840"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-545"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#InnerProd"><span class="hs-identifier hs-var">InnerProd</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262841"><a href="#local-6989586621679262841"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621679262842"><a href="#local-6989586621679262842"><span class="hs-identifier">arg2</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PInnerProd"><span class="hs-identifier hs-var">PInnerProd</span></a><span> </span><a name="local-6989586621679262843"><a href="#local-6989586621679262843"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262844"><a href="#local-6989586621679262844"><span class="hs-identifier">sp2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-546"></a><span>                </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262841"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262842"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262843"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262844"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-547"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Piecewise"><span class="hs-identifier hs-var">Piecewise</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262845"><a href="#local-6989586621679262845"><span class="hs-identifier">conditionArg</span></a></a><span> </span><a name="local-6989586621679262846"><a href="#local-6989586621679262846"><span class="hs-identifier">branchArgs</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPiecewise"><span class="hs-identifier hs-var">PPiecewise</span></a><span> </span><a name="local-6989586621679262847"><a href="#local-6989586621679262847"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621679262848"><a href="#local-6989586621679262848"><span class="hs-identifier">pl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679262849"><a href="#local-6989586621679262849"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262850"><a href="#local-6989586621679262850"><span class="hs-identifier">matchBranches</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HashedExpression.Internal.Pattern.html#matchList"><span class="hs-identifier hs-var">matchList</span></a><span> </span><a href="#local-6989586621679262753"><span class="hs-identifier hs-var">mp</span></a><span> </span><a href="#local-6989586621679262846"><span class="hs-identifier hs-var">branchArgs</span></a><span> </span><a href="#local-6989586621679262848"><span class="hs-identifier hs-var">pl</span></a><span>
</span><a name="line-549"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262851"><a href="#local-6989586621679262851"><span class="hs-identifier">matchCondition</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262845"><span class="hs-identifier hs-var">conditionArg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262847"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-550"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262851"><span class="hs-identifier hs-var">matchCondition</span></a><span> </span><a href="#local-6989586621679262850"><span class="hs-identifier hs-var">matchBranches</span></a><span>
</span><a name="line-551"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Power"><span class="hs-identifier hs-var">Power</span></a><span> </span><a name="local-6989586621679262852"><a href="#local-6989586621679262852"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679262853"><a href="#local-6989586621679262853"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPower"><span class="hs-identifier hs-var">PPower</span></a><span> </span><a name="local-6989586621679262854"><a href="#local-6989586621679262854"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PPowerConst"><span class="hs-identifier hs-var">PPowerConst</span></a><span> </span><a name="local-6989586621679262855"><a href="#local-6989586621679262855"><span class="hs-identifier">val</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-552"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679262852"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679262855"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262853"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262854"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-553"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Power"><span class="hs-identifier hs-var">Power</span></a><span> </span><a name="local-6989586621679262856"><a href="#local-6989586621679262856"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679262857"><a href="#local-6989586621679262857"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PPower"><span class="hs-identifier hs-var">PPower</span></a><span> </span><a name="local-6989586621679262858"><a href="#local-6989586621679262858"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PPowerHole"><span class="hs-identifier hs-var">PPowerHole</span></a><span> </span><a name="local-6989586621679262859"><a href="#local-6989586621679262859"><span class="hs-identifier">powerCapture</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262860"><a href="#local-6989586621679262860"><span class="hs-identifier">matchInner</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262857"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262858"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-555"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262861"><a href="#local-6989586621679262861"><span class="hs-identifier">matchPower</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-556"></a><span>                          </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-557"></a><span>                              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">powerCapturesMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-558"></a><span>                                    </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262859"><span class="hs-identifier hs-var">powerCapture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262856"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-559"></a><span>                              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262860"><span class="hs-identifier hs-var">matchInner</span></a><span> </span><a href="#local-6989586621679262861"><span class="hs-identifier hs-var">matchPower</span></a><span>
</span><a name="line-560"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Rotate"><span class="hs-identifier hs-var">Rotate</span></a><span> </span><a name="local-6989586621679262862"><a href="#local-6989586621679262862"><span class="hs-identifier">ra</span></a></a><span> </span><a name="local-6989586621679262863"><a href="#local-6989586621679262863"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRotate"><span class="hs-identifier hs-var">PRotate</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountHole"><span class="hs-identifier hs-var">PRotateAmountHole</span></a><span> </span><a name="local-6989586621679262864"><a href="#local-6989586621679262864"><span class="hs-identifier">rotateAmountCapture</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262865"><a href="#local-6989586621679262865"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262866"><a href="#local-6989586621679262866"><span class="hs-identifier">matchInner</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262863"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262865"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-562"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262867"><a href="#local-6989586621679262867"><span class="hs-identifier">matchRotateAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-563"></a><span>                          </span><a href="HashedExpression.Internal.Pattern.html#emptyMatch"><span class="hs-identifier hs-var">emptyMatch</span></a><span>
</span><a name="line-564"></a><span>                              </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rotateAmountCapturesMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-565"></a><span>                                    </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679262864"><span class="hs-identifier hs-var">rotateAmountCapture</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262862"><span class="hs-identifier hs-var">ra</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-566"></a><span>                              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-567"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#unionMatch"><span class="hs-identifier hs-var">unionMatch</span></a><span> </span><a href="#local-6989586621679262866"><span class="hs-identifier hs-var">matchInner</span></a><span> </span><a href="#local-6989586621679262867"><span class="hs-identifier hs-var">matchRotateAmount</span></a><span>
</span><a name="line-568"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ReFT"><span class="hs-identifier hs-var">ReFT</span></a><span> </span><a name="local-6989586621679262868"><a href="#local-6989586621679262868"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PReFT"><span class="hs-identifier hs-var">PReFT</span></a><span> </span><a name="local-6989586621679262869"><a href="#local-6989586621679262869"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262868"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262869"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-569"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ImFT"><span class="hs-identifier hs-var">ImFT</span></a><span> </span><a name="local-6989586621679262870"><a href="#local-6989586621679262870"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PImFT"><span class="hs-identifier hs-var">PImFT</span></a><span> </span><a name="local-6989586621679262871"><a href="#local-6989586621679262871"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262870"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262871"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-570"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#TwiceReFT"><span class="hs-identifier hs-var">TwiceReFT</span></a><span> </span><a name="local-6989586621679262872"><a href="#local-6989586621679262872"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTwiceReFT"><span class="hs-identifier hs-var">PTwiceReFT</span></a><span> </span><a name="local-6989586621679262873"><a href="#local-6989586621679262873"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262872"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262873"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-571"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#TwiceImFT"><span class="hs-identifier hs-var">TwiceImFT</span></a><span> </span><a name="local-6989586621679262874"><a href="#local-6989586621679262874"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PTwiceImFT"><span class="hs-identifier hs-var">PTwiceImFT</span></a><span> </span><a name="local-6989586621679262875"><a href="#local-6989586621679262875"><span class="hs-identifier">sp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262758"><span class="hs-identifier hs-var">recursiveAndCombine</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262874"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262875"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-572"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-575"></a><span class="hs-comment">--</span><span>
</span><a name="line-576"></a><span class="hs-identifier">turnToPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-577"></a><a name="turnToPattern"><a href="HashedExpression.Internal.Pattern.html#turnToPattern"><span class="hs-identifier">turnToPattern</span></a></a><span> </span><a name="local-6989586621679262876"><a href="#local-6989586621679262876"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679262877"><a href="#local-6989586621679262877"><span class="hs-identifier">nId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679262876"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PRef"><span class="hs-identifier hs-var">PRef</span></a><span> </span><a href="#local-6989586621679262877"><span class="hs-identifier hs-var">nId</span></a><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-580"></a><span class="hs-comment">--</span><span>
</span><a name="line-581"></a><span class="hs-identifier">buildFromPatternPower</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternPower"><span class="hs-identifier hs-type">PatternPower</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PowerValue"><span class="hs-identifier hs-type">PowerValue</span></a><span>
</span><a name="line-582"></a><a name="buildFromPatternPower"><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier">buildFromPatternPower</span></a></a><span> </span><a name="local-6989586621679262878"><a href="#local-6989586621679262878"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679262879"><a href="#local-6989586621679262879"><span class="hs-identifier">pp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-583"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679262879"><span class="hs-identifier hs-var">pp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-584"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PPowerHole"><span class="hs-identifier hs-var">PPowerHole</span></a><span> </span><a name="local-6989586621679262880"><a href="#local-6989586621679262880"><span class="hs-identifier">powerCapture</span></a></a><span>
</span><a name="line-585"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262881"><a href="#local-6989586621679262881"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262880"><span class="hs-identifier hs-var">powerCapture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">powerCapturesMap</span><span> </span><a href="#local-6989586621679262878"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-586"></a><span>                </span><a href="#local-6989586621679262881"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-587"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PPowerConst"><span class="hs-identifier hs-var">PPowerConst</span></a><span> </span><a name="local-6989586621679262882"><a href="#local-6989586621679262882"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262882"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-588"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PPowerMul"><span class="hs-identifier hs-var">PPowerMul</span></a><span> </span><a name="local-6989586621679262883"><a href="#local-6989586621679262883"><span class="hs-identifier">pp1</span></a></a><span> </span><a name="local-6989586621679262884"><a href="#local-6989586621679262884"><span class="hs-identifier">pp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-589"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier hs-var">buildFromPatternPower</span></a><span> </span><a href="#local-6989586621679262878"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262883"><span class="hs-identifier hs-var">pp1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span>
</span><a name="line-590"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier hs-var">buildFromPatternPower</span></a><span> </span><a href="#local-6989586621679262878"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262884"><span class="hs-identifier hs-var">pp2</span></a><span class="hs-special">)</span><span>
</span><a name="line-591"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PPowerSum"><span class="hs-identifier hs-var">PPowerSum</span></a><span> </span><a name="local-6989586621679262885"><a href="#local-6989586621679262885"><span class="hs-identifier">pp1</span></a></a><span> </span><a name="local-6989586621679262886"><a href="#local-6989586621679262886"><span class="hs-identifier">pp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-592"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier hs-var">buildFromPatternPower</span></a><span> </span><a href="#local-6989586621679262878"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262885"><span class="hs-identifier hs-var">pp1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-593"></a><span>            </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier hs-var">buildFromPatternPower</span></a><span> </span><a href="#local-6989586621679262878"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262886"><span class="hs-identifier hs-var">pp2</span></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>
</span><a name="line-595"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-596"></a><span class="hs-comment">--</span><span>
</span><a name="line-597"></a><span class="hs-identifier">buildFromPatternRotateAmount</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternRotateAmount"><span class="hs-identifier hs-type">PatternRotateAmount</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Expression.html#RotateAmount"><span class="hs-identifier hs-type">RotateAmount</span></a><span>
</span><a name="line-598"></a><a name="buildFromPatternRotateAmount"><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier">buildFromPatternRotateAmount</span></a></a><span> </span><a name="local-6989586621679262887"><a href="#local-6989586621679262887"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679262888"><a href="#local-6989586621679262888"><span class="hs-identifier">pra</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-599"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679262888"><span class="hs-identifier hs-var">pra</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-600"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountHole"><span class="hs-identifier hs-var">PRotateAmountHole</span></a><span> </span><a name="local-6989586621679262889"><a href="#local-6989586621679262889"><span class="hs-identifier">rotateAmountCapture</span></a></a><span>
</span><a name="line-601"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262890"><a href="#local-6989586621679262890"><span class="hs-identifier">am</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-602"></a><span>                 </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262889"><span class="hs-identifier hs-var">rotateAmountCapture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rotateAmountCapturesMap</span><span> </span><a href="#local-6989586621679262887"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-603"></a><span>                </span><a href="#local-6989586621679262890"><span class="hs-identifier hs-var">am</span></a><span>
</span><a name="line-604"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountSum"><span class="hs-identifier hs-var">PRotateAmountSum</span></a><span> </span><a name="local-6989586621679262891"><a href="#local-6989586621679262891"><span class="hs-identifier">pra1</span></a></a><span> </span><a name="local-6989586621679262892"><a href="#local-6989586621679262892"><span class="hs-identifier">pra2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-605"></a><span>            </span><span class="hs-identifier hs-var">zipWith</span><span>
</span><a name="line-606"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-607"></a><span>                </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262887"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262891"><span class="hs-identifier hs-var">pra1</span></a><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>                </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262887"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262892"><span class="hs-identifier hs-var">pra2</span></a><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span>        </span><a href="HashedExpression.Internal.Pattern.html#PRotateAmountNegate"><span class="hs-identifier hs-var">PRotateAmountNegate</span></a><span> </span><a name="local-6989586621679262893"><a href="#local-6989586621679262893"><span class="hs-identifier">pra</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-610"></a><span>            </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262887"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262893"><span class="hs-identifier hs-var">pra</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-613"></a><span class="hs-comment">--</span><span>
</span><a name="line-614"></a><span class="hs-identifier">buildFromPatternList</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-615"></a><span>       </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#PatternList"><span class="hs-identifier hs-type">PatternList</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-type">ExpressionDiff</span></a><span class="hs-special">]</span><span>
</span><a name="line-616"></a><a name="buildFromPatternList"><a href="HashedExpression.Internal.Pattern.html#buildFromPatternList"><span class="hs-identifier">buildFromPatternList</span></a></a><span> </span><a name="local-6989586621679262894"><a href="#local-6989586621679262894"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679262895"><a href="#local-6989586621679262895"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#PListHole"><span class="hs-identifier hs-var">PListHole</span></a><span> </span><a name="local-6989586621679262896"><a href="#local-6989586621679262896"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679262897"><a href="#local-6989586621679262897"><span class="hs-identifier">listCapture</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-617"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262898"><a href="#local-6989586621679262898"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262897"><span class="hs-identifier hs-var">listCapture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">listCapturesMap</span><span> </span><a href="#local-6989586621679262895"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-618"></a><span>        </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier hs-var">buildFromPattern</span></a><span> </span><a href="#local-6989586621679262894"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262895"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HashedExpression.Internal.Pattern.html#turnToPattern"><span class="hs-identifier hs-var">turnToPattern</span></a><span> </span><a href="#local-6989586621679262896"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262898"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-619"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-620"></a><span>        </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-621"></a><span>            </span><span class="hs-string">&quot;ListCapture not in the Map ListCapture [Int] which should never happens&quot;</span><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-624"></a><span class="hs-comment">--</span><span>
</span><a name="line-625"></a><span class="hs-identifier">buildFromPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#ExpressionMap"><span class="hs-identifier hs-type">ExpressionMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Match"><span class="hs-identifier hs-type">Match</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-type">ExpressionDiff</span></a><span>
</span><a name="line-626"></a><a name="buildFromPattern"><a href="HashedExpression.Internal.Pattern.html#buildFromPattern"><span class="hs-identifier">buildFromPattern</span></a></a><span> </span><a name="local-6989586621679262899"><a href="#local-6989586621679262899"><span class="hs-identifier">exp</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679262900"><a href="#local-6989586621679262900"><span class="hs-identifier">originalMp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262901"><a href="#local-6989586621679262901"><span class="hs-identifier">originalN</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679262902"><a href="#local-6989586621679262902"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span>
</span><a name="line-627"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-628"></a><span>    </span><a name="local-6989586621679262903"><a href="#local-6989586621679262903"><span class="hs-identifier">applyDiff'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Inner.html#applyDiff"><span class="hs-identifier hs-var">applyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span>
</span><a name="line-629"></a><span>    </span><span class="hs-identifier">buildFromPattern'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HashedExpression.Internal.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#ExpressionDiff"><span class="hs-identifier hs-type">ExpressionDiff</span></a><span>
</span><a name="line-630"></a><span>    </span><a name="local-6989586621679262904"><a href="#local-6989586621679262904"><span class="hs-identifier">buildFromPattern'</span></a></a><span> </span><a name="local-6989586621679262905"><a href="#local-6989586621679262905"><span class="hs-identifier">pattern</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-631"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679262905"><span class="hs-identifier hs-var">pattern</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-632"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PRef"><span class="hs-identifier hs-var">PRef</span></a><span> </span><a name="local-6989586621679262906"><a href="#local-6989586621679262906"><span class="hs-identifier">nId</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#noChange"><span class="hs-identifier hs-var">noChange</span></a><span> </span><a href="#local-6989586621679262906"><span class="hs-identifier hs-var">nId</span></a><span>
</span><a name="line-633"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PHole"><span class="hs-identifier hs-var">PHole</span></a><span> </span><a name="local-6989586621679262907"><a href="#local-6989586621679262907"><span class="hs-identifier">capture</span></a></a><span>
</span><a name="line-634"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262908"><a href="#local-6989586621679262908"><span class="hs-identifier">nId</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262907"><span class="hs-identifier hs-var">capture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">capturesMap</span><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-635"></a><span>                    </span><a href="HashedExpression.Internal.Inner.html#noChange"><span class="hs-identifier hs-var">noChange</span></a><span> </span><a href="#local-6989586621679262908"><span class="hs-identifier hs-var">nId</span></a><span>
</span><a name="line-636"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-637"></a><span>                    </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-638"></a><span>                        </span><span class="hs-string">&quot;Capture not in the Map Capture Int which should never happens&quot;</span><span>
</span><a name="line-639"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PHead"><span class="hs-identifier hs-var">PHead</span></a><span> </span><a name="local-6989586621679262909"><a href="#local-6989586621679262909"><span class="hs-identifier">pl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternList"><span class="hs-identifier hs-var">buildFromPatternList</span></a><span> </span><a href="#local-6989586621679262899"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262909"><span class="hs-identifier hs-var">pl</span></a><span>
</span><a name="line-640"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PConst"><span class="hs-identifier hs-var">PConst</span></a><span> </span><a name="local-6989586621679262910"><a href="#local-6989586621679262910"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#diffConst"><span class="hs-identifier hs-var">diffConst</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Node.html#retrieveShape"><span class="hs-identifier hs-var">retrieveShape</span></a><span> </span><a href="#local-6989586621679262901"><span class="hs-identifier hs-var">originalN</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262910"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-641"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PScalarConst"><span class="hs-identifier hs-var">PScalarConst</span></a><span> </span><a name="local-6989586621679262911"><a href="#local-6989586621679262911"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#diffConst"><span class="hs-identifier hs-var">diffConst</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679262911"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-642"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSumList"><span class="hs-identifier hs-var">PSumList</span></a><span> </span><a name="local-6989586621679262912"><a href="#local-6989586621679262912"><span class="hs-identifier">ptl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-643"></a><span>                </span><a href="HashedExpression.Internal.Inner.html#sumManyDiff"><span class="hs-identifier hs-var">sumManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternList"><span class="hs-identifier hs-var">buildFromPatternList</span></a><span> </span><a href="#local-6989586621679262899"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262912"><span class="hs-identifier hs-var">ptl</span></a><span>
</span><a name="line-644"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PMulList"><span class="hs-identifier hs-var">PMulList</span></a><span> </span><a name="local-6989586621679262913"><a href="#local-6989586621679262913"><span class="hs-identifier">ptl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-645"></a><span>                </span><a href="HashedExpression.Internal.Inner.html#mulManyDiff"><span class="hs-identifier hs-var">mulManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternList"><span class="hs-identifier hs-var">buildFromPatternList</span></a><span> </span><a href="#local-6989586621679262899"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262913"><span class="hs-identifier hs-var">ptl</span></a><span>
</span><a name="line-646"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSum"><span class="hs-identifier hs-var">PSum</span></a><span> </span><a name="local-6989586621679262914"><a href="#local-6989586621679262914"><span class="hs-identifier">sps</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#sumManyDiff"><span class="hs-identifier hs-var">sumManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262914"><span class="hs-identifier hs-var">sps</span></a><span>
</span><a name="line-647"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PMul"><span class="hs-identifier hs-var">PMul</span></a><span> </span><a name="local-6989586621679262915"><a href="#local-6989586621679262915"><span class="hs-identifier">sps</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HashedExpression.Internal.Inner.html#mulManyDiff"><span class="hs-identifier hs-var">mulManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262915"><span class="hs-identifier hs-var">sps</span></a><span>
</span><a name="line-648"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PNeg"><span class="hs-identifier hs-var">PNeg</span></a><span> </span><a name="local-6989586621679262916"><a href="#local-6989586621679262916"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-649"></a><span>                </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unaryET"><span class="hs-identifier hs-var">unaryET</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><a href="HashedExpression.Internal.Inner.html#ElementDefault"><span class="hs-identifier hs-var">ElementDefault</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262916"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-650"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PScale"><span class="hs-identifier hs-var">PScale</span></a><span> </span><a name="local-6989586621679262917"><a href="#local-6989586621679262917"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262918"><a href="#local-6989586621679262918"><span class="hs-identifier">sp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-651"></a><span>                </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#binaryET"><span class="hs-identifier hs-var">binaryET</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Scale"><span class="hs-identifier hs-var">Scale</span></a><span> </span><a href="HashedExpression.Internal.Inner.html#ElementDefault"><span class="hs-identifier hs-var">ElementDefault</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-652"></a><span>                </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262917"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262918"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-653"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PDiv"><span class="hs-identifier hs-var">PDiv</span></a><span> </span><a name="local-6989586621679262919"><a href="#local-6989586621679262919"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262920"><a href="#local-6989586621679262920"><span class="hs-identifier">sp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-654"></a><span>                </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Div"><span class="hs-identifier hs-var">Div</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262919"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262920"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-655"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSqrt"><span class="hs-identifier hs-var">PSqrt</span></a><span> </span><a name="local-6989586621679262921"><a href="#local-6989586621679262921"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Sqrt"><span class="hs-identifier hs-var">Sqrt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262921"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-656"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSin"><span class="hs-identifier hs-var">PSin</span></a><span> </span><a name="local-6989586621679262922"><a href="#local-6989586621679262922"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Sin"><span class="hs-identifier hs-var">Sin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262922"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-657"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PCos"><span class="hs-identifier hs-var">PCos</span></a><span> </span><a name="local-6989586621679262923"><a href="#local-6989586621679262923"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Cos"><span class="hs-identifier hs-var">Cos</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262923"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-658"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PTan"><span class="hs-identifier hs-var">PTan</span></a><span> </span><a name="local-6989586621679262924"><a href="#local-6989586621679262924"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Tan"><span class="hs-identifier hs-var">Tan</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262924"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-659"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PExp"><span class="hs-identifier hs-var">PExp</span></a><span> </span><a name="local-6989586621679262925"><a href="#local-6989586621679262925"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262925"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-660"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PLog"><span class="hs-identifier hs-var">PLog</span></a><span> </span><a name="local-6989586621679262926"><a href="#local-6989586621679262926"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Log"><span class="hs-identifier hs-var">Log</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262926"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-661"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSinh"><span class="hs-identifier hs-var">PSinh</span></a><span> </span><a name="local-6989586621679262927"><a href="#local-6989586621679262927"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Sinh"><span class="hs-identifier hs-var">Sinh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262927"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-662"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PCosh"><span class="hs-identifier hs-var">PCosh</span></a><span> </span><a name="local-6989586621679262928"><a href="#local-6989586621679262928"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Cosh"><span class="hs-identifier hs-var">Cosh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262928"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-663"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PTanh"><span class="hs-identifier hs-var">PTanh</span></a><span> </span><a name="local-6989586621679262929"><a href="#local-6989586621679262929"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Tanh"><span class="hs-identifier hs-var">Tanh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262929"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-664"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAsin"><span class="hs-identifier hs-var">PAsin</span></a><span> </span><a name="local-6989586621679262930"><a href="#local-6989586621679262930"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Asin"><span class="hs-identifier hs-var">Asin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262930"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-665"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAcos"><span class="hs-identifier hs-var">PAcos</span></a><span> </span><a name="local-6989586621679262931"><a href="#local-6989586621679262931"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Acos"><span class="hs-identifier hs-var">Acos</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262931"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-666"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAtan"><span class="hs-identifier hs-var">PAtan</span></a><span> </span><a name="local-6989586621679262932"><a href="#local-6989586621679262932"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Atan"><span class="hs-identifier hs-var">Atan</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262932"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-667"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAsinh"><span class="hs-identifier hs-var">PAsinh</span></a><span> </span><a name="local-6989586621679262933"><a href="#local-6989586621679262933"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Asinh"><span class="hs-identifier hs-var">Asinh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262933"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-668"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAcosh"><span class="hs-identifier hs-var">PAcosh</span></a><span> </span><a name="local-6989586621679262934"><a href="#local-6989586621679262934"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Acosh"><span class="hs-identifier hs-var">Acosh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262934"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-669"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PAtanh"><span class="hs-identifier hs-var">PAtanh</span></a><span> </span><a name="local-6989586621679262935"><a href="#local-6989586621679262935"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#Atanh"><span class="hs-identifier hs-var">Atanh</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262935"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-670"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PRealImag"><span class="hs-identifier hs-var">PRealImag</span></a><span> </span><a name="local-6989586621679262936"><a href="#local-6989586621679262936"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262937"><a href="#local-6989586621679262937"><span class="hs-identifier">sp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-671"></a><span>                </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#binary"><span class="hs-identifier hs-var">binary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#RealImag"><span class="hs-identifier hs-var">RealImag</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262936"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262937"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-672"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PRealPart"><span class="hs-identifier hs-var">PRealPart</span></a><span> </span><a name="local-6989586621679262938"><a href="#local-6989586621679262938"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#RealPart"><span class="hs-identifier hs-var">RealPart</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262938"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-673"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PImagPart"><span class="hs-identifier hs-var">PImagPart</span></a><span> </span><a name="local-6989586621679262939"><a href="#local-6989586621679262939"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#ImagPart"><span class="hs-identifier hs-var">ImagPart</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262939"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-674"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PInnerProd"><span class="hs-identifier hs-var">PInnerProd</span></a><span> </span><a name="local-6989586621679262940"><a href="#local-6989586621679262940"><span class="hs-identifier">sp1</span></a></a><span> </span><a name="local-6989586621679262941"><a href="#local-6989586621679262941"><span class="hs-identifier">sp2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-675"></a><span>                </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#binaryET"><span class="hs-identifier hs-var">binaryET</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#InnerProd"><span class="hs-identifier hs-var">InnerProd</span></a><span> </span><a href="HashedExpression.Internal.Inner.html#ElementDefault"><span class="hs-identifier hs-var">ElementDefault</span></a><span> </span><span class="hs-special">`</span><a href="HashedExpression.Internal.Inner.html#hasShape"><span class="hs-identifier hs-var">hasShape</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-676"></a><span>                </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262940"><span class="hs-identifier hs-var">sp1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262941"><span class="hs-identifier hs-var">sp2</span></a><span class="hs-special">]</span><span>
</span><a name="line-677"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PPiecewise"><span class="hs-identifier hs-var">PPiecewise</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-678"></a><span>                </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-679"></a><span>                    </span><span class="hs-string">&quot;Pattern piecewise appear on the right side of normalizier rules which we haven't had yet&quot;</span><span>
</span><a name="line-680"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PMulRest"><span class="hs-identifier hs-var">PMulRest</span></a><span> </span><a name="local-6989586621679262942"><a href="#local-6989586621679262942"><span class="hs-identifier">restCapture</span></a></a><span> </span><a name="local-6989586621679262943"><a href="#local-6989586621679262943"><span class="hs-identifier">sps</span></a></a><span>
</span><a name="line-681"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262944"><a href="#local-6989586621679262944"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262942"><span class="hs-identifier hs-var">restCapture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">listCapturesMap</span><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-682"></a><span>                    </span><a href="HashedExpression.Internal.Inner.html#mulManyDiff"><span class="hs-identifier hs-var">mulManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-683"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HashedExpression.Internal.Inner.html#noChange"><span class="hs-identifier hs-var">noChange</span></a><span> </span><a href="#local-6989586621679262944"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262943"><span class="hs-identifier hs-var">sps</span></a><span>
</span><a name="line-684"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PSumRest"><span class="hs-identifier hs-var">PSumRest</span></a><span> </span><a name="local-6989586621679262945"><a href="#local-6989586621679262945"><span class="hs-identifier">restCapture</span></a></a><span> </span><a name="local-6989586621679262946"><a href="#local-6989586621679262946"><span class="hs-identifier">sps</span></a></a><span>
</span><a name="line-685"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679262947"><a href="#local-6989586621679262947"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679262945"><span class="hs-identifier hs-var">restCapture</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">listCapturesMap</span><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-686"></a><span>                    </span><a href="HashedExpression.Internal.Inner.html#sumManyDiff"><span class="hs-identifier hs-var">sumManyDiff</span></a><span> </span><a href="#local-6989586621679262900"><span class="hs-identifier hs-var">originalMp</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-687"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="HashedExpression.Internal.Inner.html#noChange"><span class="hs-identifier hs-var">noChange</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679262947"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679262946"><span class="hs-identifier hs-var">sps</span></a><span>
</span><a name="line-688"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PPower"><span class="hs-identifier hs-var">PPower</span></a><span> </span><a name="local-6989586621679262948"><a href="#local-6989586621679262948"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621679262949"><a href="#local-6989586621679262949"><span class="hs-identifier">pp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-689"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262950"><a href="#local-6989586621679262950"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternPower"><span class="hs-identifier hs-var">buildFromPatternPower</span></a><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262949"><span class="hs-identifier hs-var">pp</span></a><span>
</span><a name="line-690"></a><span>                 </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Power"><span class="hs-identifier hs-var">Power</span></a><span> </span><a href="#local-6989586621679262950"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262948"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-691"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PRotate"><span class="hs-identifier hs-var">PRotate</span></a><span> </span><a name="local-6989586621679262951"><a href="#local-6989586621679262951"><span class="hs-identifier">pra</span></a></a><span> </span><a name="local-6989586621679262952"><a href="#local-6989586621679262952"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-692"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262953"><a href="#local-6989586621679262953"><span class="hs-identifier">rotateAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HashedExpression.Internal.Pattern.html#buildFromPatternRotateAmount"><span class="hs-identifier hs-var">buildFromPatternRotateAmount</span></a><span> </span><a href="#local-6989586621679262902"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679262951"><span class="hs-identifier hs-var">pra</span></a><span>
</span><a name="line-693"></a><span>                 </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span>
</span><a name="line-694"></a><span>                        </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Expression.html#Rotate"><span class="hs-identifier hs-var">Rotate</span></a><span> </span><a href="#local-6989586621679262953"><span class="hs-identifier hs-var">rotateAmount</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>                        </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262952"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-696"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PReFT"><span class="hs-identifier hs-var">PReFT</span></a><span> </span><a name="local-6989586621679262954"><a href="#local-6989586621679262954"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#ReFT"><span class="hs-identifier hs-var">ReFT</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262954"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-697"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PImFT"><span class="hs-identifier hs-var">PImFT</span></a><span> </span><a name="local-6989586621679262955"><a href="#local-6989586621679262955"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#ImFT"><span class="hs-identifier hs-var">ImFT</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262955"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-698"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PTwiceReFT"><span class="hs-identifier hs-var">PTwiceReFT</span></a><span> </span><a name="local-6989586621679262956"><a href="#local-6989586621679262956"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#TwiceReFT"><span class="hs-identifier hs-var">TwiceReFT</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262956"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-699"></a><span>            </span><a href="HashedExpression.Internal.Pattern.html#PTwiceImFT"><span class="hs-identifier hs-var">PTwiceImFT</span></a><span> </span><a name="local-6989586621679262957"><a href="#local-6989586621679262957"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679262903"><span class="hs-identifier hs-var">applyDiff'</span></a><span> </span><span class="hs-special">(</span><a href="HashedExpression.Internal.Inner.html#unary"><span class="hs-identifier hs-var">unary</span></a><span> </span><a href="HashedExpression.Internal.Expression.html#TwiceImFT"><span class="hs-identifier hs-var">TwiceImFT</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262904"><span class="hs-identifier hs-var">buildFromPattern'</span></a><span> </span><a href="#local-6989586621679262957"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">]</span><span>
</span><a name="line-700"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-701"></a><span>                </span><span class="hs-identifier hs-var">error</span><span>
</span><a name="line-702"></a><span>                    </span><span class="hs-string">&quot;The right hand-side of substitution has something that we don't support yet&quot;</span><span>
</span><a name="line-703"></a></pre></body></html>